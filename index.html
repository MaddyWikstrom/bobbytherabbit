<!DOCTYPE html>
<!-- Updated with cart render fix -->
<html lang="en" data-netlify="true">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bungi x Bobby | The Tech Animal Collection</title>
    <link rel="icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.png">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/loading.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/homepage-products.css">
    <link rel="stylesheet" href="styles/cart-styles.css">
    <link rel="stylesheet" href="styles/quick-view.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Script Loader to prevent duplicate script loading -->
    <script src="scripts/script-loader-fix.js"></script>
    
    <!-- Prevent cart clearing during checkout - MUST LOAD FIRST -->
    <script src="scripts/prevent-checkout-clear.js"></script>
    
    <!-- Back Button Cart Fix - loads early to catch back button events -->
    <script src="scripts/back-button-cart-fix.js"></script>
    
    <!-- Cart System with improved initialization to avoid password screen conflicts -->
    <script>
        // Define a cart initialization flag to track state
        window.cartSystemReady = false;
        
        // Create a function to safely load the cart system only after password verification
        function initializeCartSystem() {
            console.log("Initializing cart system after password verification");
            
            // Only load if not already loaded
            if (!window.cartSystemReady) {
                // Use the script loader to prevent duplicates
                if (window.BobbyScriptLoader) {
                    // Load Shopify ID handler first
                    window.BobbyScriptLoader.loadOnce('shopify-id-handler', '/scripts/shopify-id-handler.js', function(success) {
                        if (success) {
                            console.log("Shopify ID handler loaded successfully");
                            
                            // Then load cart system
                            window.BobbyScriptLoader.loadOnce('simple-cart-system', '/scripts/simple-cart-system.js', function(success) {
                                if (success) {
                                    console.log("Cart system script loaded successfully");
                                    
                                    // After cart system loads, load bridge fix
                                    window.BobbyScriptLoader.loadOnce('cart-bridge-fix', '/scripts/cart-bridge-fix.js', function(success) {
                                if (success) {
                                    console.log("Cart bridge fix loaded successfully");
                                } else {
                                    console.error("Failed to load cart bridge fix");
                                }
                            });
                            
                            window.cartSystemReady = true;
                        } else {
                            console.error("Failed to load cart system script");
                        }
                    });
                } else {
                    console.error("Failed to load Shopify ID handler");
                }
            });
                } else {
                    // Fallback to direct loading if script loader isn't available
                    // Load Shopify ID handler first
                    const shopifyIdHandler = document.createElement('script');
                    shopifyIdHandler.src = "/scripts/shopify-id-handler.js";
                    shopifyIdHandler.onload = function() {
                        // Then load cart system
                        const simpleCartScript = document.createElement('script');
                        simpleCartScript.src = "/scripts/simple-cart-system.js";
                        simpleCartScript.async = true;
                        document.head.appendChild(simpleCartScript);
                    };
                    document.head.appendChild(shopifyIdHandler);
                    console.warn("Script loader not available, using direct loading");
                    window.cartSystemReady = true;
                }
            }
        }
    </script>
    <style>
        .password-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 50%, #0a0a0a 100%);
            font-family: 'Orbitron', monospace;
            position: relative;
            overflow: hidden;
        }
        
        .password-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 119, 198, 0.1) 0%, transparent 50%);
            animation: pulse 4s ease-in-out infinite alternate;
        }
        
        .password-container {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #7877c6;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            position: relative;
            z-index: 10;
            box-shadow:
                0 0 30px rgba(120, 119, 198, 0.5),
                inset 0 0 30px rgba(120, 119, 198, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .password-title {
            color: #7877c6;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 3px;
            position: relative;
            animation: glitch-text 3s infinite;
        }
        
        .password-title::before,
        .password-title::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .password-title::before {
            animation: glitch-1 0.5s infinite;
            color: #ff77c6;
            z-index: -1;
        }
        
        .password-title::after {
            animation: glitch-2 0.5s infinite;
            color: #77c6ff;
            z-index: -2;
        }
        
        .password-input {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #7877c6;
            border-radius: 5px;
            padding: 15px 20px;
            font-size: 1.2rem;
            color: #7877c6;
            font-family: 'Orbitron', monospace;
            width: 300px;
            margin-bottom: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .password-input:focus {
            outline: none;
            border-color: #ff77c6;
            box-shadow: 0 0 20px rgba(255, 119, 198, 0.5);
            color: #ff77c6;
        }
        
        .password-input::placeholder {
            color: rgba(120, 119, 198, 0.5);
        }
        
        .password-submit {
            background: linear-gradient(45deg, #7877c6, #ff77c6);
            border: none;
            border-radius: 5px;
            padding: 15px 30px;
            font-size: 1.1rem;
            color: #000;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .password-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(120, 119, 198, 0.4);
        }
        
        .password-submit:active {
            transform: translateY(0);
        }
        
        .password-error {
            color: #ff4757;
            font-size: 1rem;
            margin-top: 15px;
            font-family: 'Orbitron', monospace;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @keyframes glitch-text {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
        }
        
        @keyframes glitch-1 {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
        }
        
        @keyframes glitch-2 {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(2px, -2px); }
            40% { transform: translate(2px, 2px); }
            60% { transform: translate(-2px, -2px); }
            80% { transform: translate(-2px, 2px); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <!-- Password Entry Screen -->
    <div id="password-screen" class="password-screen" style="display: flex;">
        <div class="password-container">
            <h2 class="password-title" data-text="ACCESS REQUIRED">ACCESS REQUIRED</h2>
            <input type="password" id="password-input" class="password-input" placeholder="Enter Password" />
            <button id="submit-password" class="password-submit">AUTHENTICATE</button>
            <div id="error-message" class="password-error" style="display: none;">ACCESS DENIED. TRY AGAIN.</div>
        </div>
    </div>
    
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen" style="display: none;">
        <div class="loading-container">
            <div class="loading-logo-container">
                <div class="cookie-wrapper">
                    <img src="assets/cookie_high.png" alt="Cookie" class="loading-cookie" id="loading-cookie">
                    <div class="cookie-pixels"></div>
                    <div class="cookie-crumbs"></div>
                </div>
                <img src="assets/bobby-logo.svg" alt="BUNGI X BOBBY" class="loading-logo">
                <div class="glitch-overlay"></div>
            </div>
            <div class="loading-text">
                <span class="glitch-text" data-text="INITIALIZING">INITIALIZING</span>
            </div>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                    <div class="progress-glow"></div>
                </div>
                <div class="progress-text">0%</div>
            </div>
            <div class="loading-particles"></div>
        </div>
    </div>

    <!-- Main Website -->
    <div id="main-site" class="main-site hidden">
        <!-- Background Pattern -->
        <div class="bg-pattern"></div>
        <div class="glitch-overlay"></div>
        <div class="grid-details"></div>
        
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <img src="assets/bobby-logo.svg" alt="Bobby" class="nav-logo-img">
                    <span class="nav-brand">BUNGI X BOBBY</span>
                    <div class="logo-banner">
                        <div class="logo-container">
                          <img src="assets/hat.png" class="banner-logo hat" alt="Hat logo" />
                          <img src="assets/cookie.png" class="banner-logo cookie" alt="Cookie logo" />
                          <img src="assets/bunny.png" class="banner-logo bunny" alt="Bunny logo" />
                          <img src="assets/b.png" class="banner-logo b" alt="B logo" />
                        </div>
                      </div>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="#home" class="nav-link glitch-hover" data-text="HOME">HOME</a></li>
                    <li class="nav-item"><a href="products.html" class="nav-link glitch-hover" data-text="SHOP">SHOP</a></li>
                    <li class="nav-item"><a href="#collection" class="nav-link glitch-hover" data-text="COLLECTION">COLLECTION</a></li>
                    <li class="nav-item"><a href="#about" class="nav-link glitch-hover" data-text="ABOUT">ABOUT</a></li>
                    <li class="nav-item"><a href="#contact" class="nav-link glitch-hover" data-text="CONTACT">CONTACT</a></li>
                </ul>
                <div class="nav-actions">
                    <button class="cart-btn" id="cart-btn">
                        <span class="cart-icon">üõí</span>
                        <span class="cart-count">0</span>
                    </button>
                    <div class="social-links">
                        <a href="https://instagram.com/bungi_bobby_the_rabbit" class="social-link instagram" target="_blank">
                            <span class="hologram-btn">
                                <img src="assets/instagram-logo.svg" alt="Instagram" class="social-icon">
                            </span>
                        </a>
                        <a href="https://tiktok.com/@bungi__" class="social-link tiktok" target="_blank">
                            <span class="hologram-btn">
                                <img src="assets/tiktok-logo.svg" alt="TikTok" class="social-icon">
                            </span>
                        </a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="hero-bg">
                <div class="particle-field"></div>
                <div class="grid-overlay"></div>
            </div>
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        <span class="glitch-text" data-text="BUNGI X BOBBY">BUNGI X BOBBY</span>
                        <span class="subtitle">THE TECH ANIMAL COLLECTION</span>
                    </h1>
                    <p class="hero-description">
                        Tech animal of the elite GooberMcGeet club
                    </p>
                    <button class="cta-btn" onclick="window.location.href='products.html'">
                        <span>EXPLORE COLLECTION</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>
                <div class="hero-product">
                    <div class="product-showcase">
                        <div class="product-3d">
                            <img src="assets/featured-hoodie.svg" alt="Featured Hoodie" class="product-img">
                            <div class="product-hologram"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Collection Section -->
        <section id="collection" class="collection">
            <h2 class="section-title">
                <span class="glitch-text glitch-collection" data-text="COLLECTION">COLLECTION</span>
            </h2>
            <div class="container">
                <!-- Arrow Buttons -->
                <div class="arrow-container">
                    <button class="arrow left-arrow" id="scroll-left">&#9664;</button>
                    <button class="arrow right-arrow" id="scroll-right">&#9654;</button>
                </div>
                <div class="product-scroll-container">
                    <div class="product-grid-scroll" id="homepage-products">
                        <!-- Products will be dynamically loaded here -->
                        <div class="loading-products">
                            <div class="loading-spinner"></div>
                            <p>Loading products...</p>
                        </div>
                    </div>
                </div>
                <div class="view-all-container">
                    <button class="view-all-btn" onclick="window.location.href='products.html'">
                        <span>VIEW ALL PRODUCTS</span>
                        <div class="btn-glow"></div>
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="about">
            <div class="container">
                <div class="about-content">
                    <div class="about-text">
                        <h2 class="section-title">
                            <span class="glitch-text" data-text="ABOUT BOBBY">ABOUT BOBBY</span>
                        </h2>
                        <p class="about-description">
                            In the neon-lit streets of the digital underground, Bobby the Rabbit reigns supreme as the ultimate Tech Animal of the elite GooberMcGeet Club. This collection isn't just fashion ‚Äì it's Bobby's world, brought to life. Each piece channels his rebellious spirit, underground edge, and love for cookies, blending high-tech aesthetics with a streetwise vibe. Gear up and step into Bobby's digital domain ‚Äì where you're not just part of the scene, you're the Tech Animal of the elite GooberMcGeet Club. Join Bobby's crew ‚Äì where the tech animals run wild and cookies are always within reach.
                        </p>
                        <div class="ascii-art">
                            <pre class="ascii-bobby">
     ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
     ‚ïë         BUNGI X BOBBY           ‚ïë
     ‚ïë   THE TECH ANIMAL COLLECTION    ‚ïë
     ‚ïë                                 ‚ïë
     ‚ïë   > PREMIUM QUALITY             ‚ïë
     ‚ïë   > DYSTOPIAN DESIGN            ‚ïë
     ‚ïë   > TECH ELITE STATUS           ‚ïë
     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                            </pre>
                        </div>
                    </div>
                    <div class="about-visual">
                        <div class="tech-grid">
                            <div class="grid-item">
                                <img src="assets/profren1.png" alt="Tech Visual 1" class="grid-image">
                            </div>
                            <div class="grid-item">
                                <img src="assets/ren2.png" alt="Tech Visual 2" class="grid-image">
                            </div>
                            <div class="grid-item">
                                <img src="assets/ren3.png" alt="Tech Visual 3" class="grid-image">
                            </div>
                            <div class="grid-item">
                                <img src="assets/ren4.png" alt="Tech Visual 4" class="grid-image">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3 class="footer-title">BUNGI X BOBBY</h3>
                        <p class="footer-text">Tech animal of the elite GooberMcGeet club</p>
                        <div class="social-links-footer">
                            <a href="https://instagram.com/bungi_bobby_the_rabbit" class="social-link" target="_blank">
                                <span class="hologram-btn">
                                    <img src="assets/instagram-logo.svg" alt="Instagram" class="social-icon">
                                </span>
                            </a>
                            <a href="https://tiktok.com/@bungi__" class="social-link" target="_blank">
                                <span class="hologram-btn">
                                    <img src="assets/tiktok-logo.svg" alt="TikTok" class="social-icon">
                                </span>
                            </a>
                        </div>
                    </div>
                    <div class="footer-section">
                        <h3 class="footer-title">QUICK LINKS</h3>
                        <ul class="footer-links">
                            <li><a href="#home">Home</a></li>
                            <li><a href="#collection">Collection</a></li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#contact">Contact</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h3 class="footer-title">CONTACT</h3>
                        <p class="footer-text">bungi.bobby@gmail.com</p>
                    </div>
                </div>
                <div class="footer-bottom">
                    <div class="ascii-footer">
                        <pre>
     _______  ________   _______   _______   ________      ________       _______  _______    _______   _______  ________ 
     //      / /    /   \//   /   \//       \ /        \    /    /   \    //      / /       \\//      / //      / /    /   \
    //       \/         //        //      __/_/       /    /_       _/   //       \/        ///       \//       \/         /
   /         /        //         /       / //         /   /         /   /         /         /         /         /\__     // 
   \________/\_______//\__/_____/\________/ \\_______/    \___/___//    \________/\________/\________/\________/   \____//  
    </pre>
                    </div>
                    <p class="copyright">¬© 2025 BUNGI X BOBBY. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Note: Cart elements are now dynamically created by simple-cart-system.js -->

    <script>
        // Password validation functionality - complete rewrite to fix typing issues
        window.addEventListener('load', function() {
            console.log("Password system initializing");
            
            const correctPassword = "bajablastrabbit47";
            const submitButton = document.getElementById("submit-password");
            const passwordInput = document.getElementById("password-input");
            const errorMessage = document.getElementById("error-message");
            const passwordScreen = document.getElementById("password-screen");
            const loadingScreen = document.getElementById("loading-screen");
            
            // Immediately make sure input is enabled
            if (passwordInput) {
                passwordInput.removeAttribute('disabled');
                passwordInput.value = '';
                console.log("Password input ready");
                
                // Force focus after a slight delay to ensure browser is ready
                setTimeout(function() {
                    passwordInput.focus();
                    console.log("Focus set on password input");
                }, 300);
            } else {
                console.error("Password input element not found");
            }
            
            // Single global processing flag
            let passwordProcessing = false;
            
            // Clear submit handler function
            function handlePasswordSubmit() {
                console.log("Submit handler called");
                
                // Prevent multiple submissions
                if (passwordProcessing) {
                    console.log("Already processing, ignoring request");
                    return;
                }
                
                passwordProcessing = true;
                console.log("Processing password submission");
                
                // Get current value
                const enteredPassword = passwordInput.value;
                console.log("Password entered (length: " + enteredPassword.length + ")");
                
                if (enteredPassword === correctPassword) {
                    console.log("Password correct!");
                    
                    // Hide password screen
                    passwordScreen.style.display = "none";
                    
                    // Show loading screen
                    loadingScreen.style.display = "flex";
                    
                    // Safely initialize loading screen and cart system
                    setTimeout(function() {
                        try {
                            console.log("Starting loading screen");
                            
                            // Initialize cart system first
                            initializeCartSystem();
                            
                            // Then initialize loading screen
                            initializeLoadingScreen();
                        } catch (err) {
                            console.error("Error in loading screen:", err);
                            
                            // Still try to initialize cart
                            try {
                                initializeCartSystem();
                            } catch (cartErr) {
                                console.error("Error initializing cart:", cartErr);
                            }
                            
                            // Fallback: show main site directly in case of error
                            loadingScreen.style.display = "none";
                            document.getElementById("main-site").classList.remove("hidden");
                        }
                    }, 500);
                } else {
                    console.log("Password incorrect");
                    errorMessage.style.display = "block";
                    passwordInput.value = ""; // Clear the input
                    
                    // Reset processing flag after delay
                    setTimeout(function() {
                        passwordProcessing = false;
                        passwordInput.focus();
                    }, 300);
                }
            }
            
            // Click handler for submit button
            if (submitButton) {
                submitButton.addEventListener("click", function(event) {
                    event.preventDefault();
                    event.stopPropagation();
                    handlePasswordSubmit();
                });
                console.log("Submit button handler attached");
            }
            
            // Keyboard handler for password input
            if (passwordInput) {
                passwordInput.addEventListener("keydown", function(event) {
                    if (event.key === "Enter") {
                        event.preventDefault();
                        event.stopPropagation();
                        handlePasswordSubmit();
                    }
                });
                console.log("Keyboard handler attached");
                
                // Additional keyup handler to verify typing works
                passwordInput.addEventListener("keyup", function() {
                    console.log("Key pressed - current length: " + passwordInput.value.length);
                });
            }
            
            console.log("Password system ready");
        });
    </script>
    
    <script src="scripts/main.js"></script>
    <script src="scripts/loading.js"></script>
    <script src="scripts/animations.js"></script>
    <script src="scripts/homepage-products.js"></script>
    
    <!-- Shopify Integration - Option B -->
    <script src="scripts/shopify-integration.js"></script>
    
    <!-- Critical fixes -->
    <script src="scripts/mobile-navigation.js"></script>
    <script src="scripts/image-loader-fix.js"></script>
    
    <!-- Quick View functionality -->
    <script src="scripts/quick-view.js"></script>
    
    <!-- Cart Fixes - Using script loader to prevent duplicate loading -->
    <script>
        // Use script loader to load cart scripts in the correct order
        if (window.BobbyScriptLoader) {
            // Load scripts in sequence with dependencies
            BobbyScriptLoader.loadOnce('shopify-id-handler', 'scripts/shopify-id-handler.js', function() {
                BobbyScriptLoader.loadOnce('simple-cart-system', 'scripts/simple-cart-system.js', function() {
                    BobbyScriptLoader.loadOnce('cart-bridge-fix', 'scripts/cart-bridge-fix.js', function() {
                        BobbyScriptLoader.loadOnce('cart-duplicate-fix', 'scripts/cart-duplicate-fix.js', function() {
                            BobbyScriptLoader.loadOnce('cart-render-fix', 'scripts/cart-render-fix.js', function() {
                                // Load cart persistence systems last to ensure they can hook into all cart systems
                                BobbyScriptLoader.loadOnce('cart-persistence', 'scripts/cart-persistence.js', function() {
                                    // Cross-domain cart persistence for checkout between different domains
                                    BobbyScriptLoader.loadOnce('cross-domain-cart', 'scripts/cross-domain-cart.js');
                                });
                            });
                        });
                    });
                });
            });
        } else {
            // Fallback to standard script tags if loader isn't available
            document.write('<script src="scripts/shopify-id-handler.js"><\/script>');
            document.write('<script src="scripts/simple-cart-system.js"><\/script>');
            document.write('<script src="scripts/cart-bridge-fix.js"><\/script>');
            document.write('<script src="scripts/cart-duplicate-fix.js"><\/script>');
            document.write('<script src="scripts/cart-render-fix.js"><\/script>');
        }
    </script>
    
    <!-- Collection Wave Background -->
    <script src="scripts/collection-wave-bg.js"></script>
    
    <!-- Improved cart button handler for homepage -->
    <script>
        // Ensure cart button on homepage works properly
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Setting up cart button handler');
            const cartButton = document.getElementById('cart-btn');
            if (cartButton) {
                cartButton.addEventListener('click', function() {
                    console.log('Cart button clicked on homepage');
                    
                    // Try to open cart system - attempt to use the bridge first
                    try {
                        // Try BobbyCart first (primary system)
                        if (window.BobbyCart && typeof window.BobbyCart.openCart === 'function') {
                            window.BobbyCart.openCart();
                            return;
                        }
                        
                        // Fall back to cartManager
                        if (window.cartManager) {
                            if (typeof window.cartManager.openCart === 'function') {
                                window.cartManager.openCart();
                                return;
                            } else if (typeof window.cartManager.toggleCart === 'function') {
                                window.cartManager.toggleCart();
                                return;
                            }
                        }
                        
                        // Last resort - try to access the cart directly
                        const cartSidebar = document.getElementById('cart-sidebar');
                        const cartOverlay = document.getElementById('cart-overlay');
                        
                        if (cartSidebar) {
                            cartSidebar.style.display = 'flex';
                            cartSidebar.classList.add('active');
                            cartSidebar.style.transform = 'translateX(0)';
                            cartSidebar.style.opacity = '1';
                            cartSidebar.style.visibility = 'visible';
                            
                            if (cartOverlay) {
                                cartOverlay.style.display = 'block';
                                cartOverlay.style.opacity = '1';
                            }
                        } else {
                            console.error('No cart elements found to open');
                        }
                    } catch (error) {
                        console.error('Error opening cart:', error);
                        alert('The cart system is currently unavailable. Please try again later.');
                    }
                });
                console.log('Homepage cart button handler attached');
            } else {
                console.warn('Cart button not found on page');
            }
        });
    </script>
</body>
</html>